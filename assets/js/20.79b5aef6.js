(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{329:function(t,s,a){"use strict";a.r(s);var n=a(6),p=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"python批量对多个pdf文件进行加密"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#python批量对多个pdf文件进行加密"}},[t._v("#")]),t._v(" Python批量对多个PDF文件进行加密")]),t._v(" "),s("h3",{attrs:{id:"应用场景"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#应用场景"}},[t._v("#")]),t._v(" 应用场景：")]),t._v(" "),s("p",[t._v("批量对多个PDF文件进行加密的应用场景包括但不限于：")]),t._v(" "),s("ol",[s("li",[s("strong",[t._v("信息保护")]),t._v("：在许多场合，如公司、机关单位、个人等，都有大量的PDF文件需要保护，以防止信息泄露或被不当使用。在这些情况下，批量加密PDF文件是一种有效的保护手段。")]),t._v(" "),s("li",[s("strong",[t._v("文件分发")]),t._v("：当需要向大量用户分发PDF文件时，可以通过批量加密PDF文件，以保证只有具有解密权限的用户才能查看和编辑文件。这可以大大提高文件分发的安全性和效率。")]),t._v(" "),s("li",[s("strong",[t._v("电子文档管理")]),t._v("：在某些场景下，如图书馆、档案馆、设计公司等，需要大量处理和管理PDF文件。在这些场合，批量加密PDF文件可以有效地保护电子文档的安全，防止未授权的访问和使用。")]),t._v(" "),s("li",[s("strong",[t._v("在线学习")]),t._v("：在线教育平台或网课中，学生需要访问和下载老师的PDF课件。通过批量加密PDF课件，可以防止学生随意复制、打印或传播课件内容，从而保证知识产权的保护和在线学习的效果。")]),t._v(" "),s("li",[s("strong",[t._v("电子签名")]),t._v("：在某些情况下，如合同、协议、证明等文件的签署，需要使用PDF格式的文件。通过批量加密PDF文件，可以防止他人篡改或复制文件内容，从而保证文件的真实性和完整性。")])]),t._v(" "),s("p",[t._v("总的来说，批量对多个PDF文件进行加密可以在任何需要对大量PDF文件进行安全保护的场景中使用。")]),t._v(" "),s("h3",{attrs:{id:"代码实现思路"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#代码实现思路"}},[t._v("#")]),t._v(" 代码实现思路")]),t._v(" "),s("p",[t._v("要批量对多个PDF文件进行加密，可以使用Python的PyPDF2库。首先设置一个密码，用于对PDF文件进行加密。然后指定要加密的PDF文件所在的目录，并获取目录下所有以“.pdf”为后缀的文件列表。接下来，循环遍历每个PDF文件，并使用PyPDF2库对其进行加密。对于每个PDF文件，代码会先读取文件内容，并使用"),s("code",[t._v("PdfFileReader")]),t._v("类获取文件的页数。然后，循环遍历每一页，并对每一页使用"),s("code",[t._v("encrypt()")]),t._v("方法进行加密。最后，将加密后的内容写入到一个新的PDF文件中，并使用"),s("code",[t._v("PdfFileWriter")]),t._v("类完成写入操作。")]),t._v(" "),s("h3",{attrs:{id:"python代码实现"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#python代码实现"}},[t._v("#")]),t._v(" python代码实现")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" os  \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" PyPDF2 "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" PdfFileWriter"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" PdfFileReader  \n  \n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 设置密码  ")]),t._v("\npassword "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"your_password"')]),t._v("  \n  \n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 获取目录下所有PDF文件  ")]),t._v("\npdf_dir "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/path/to/pdf/directory"')]),t._v("  \npdf_files "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("f "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" f "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" os"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("listdir"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pdf_dir"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" f"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("endswith"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('".pdf"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("  \n  \n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 循环遍历每个PDF文件并加密  ")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" pdf_file "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" pdf_files"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("  \n    input_file "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" os"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("join"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pdf_dir"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" pdf_file"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  \n    output_file "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" os"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("join"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pdf_dir"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string-interpolation"}},[s("span",{pre:!0,attrs:{class:"token string"}},[t._v('f"')]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("pdf_file"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('_encrypted.pdf"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  \n      \n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 读取PDF文件  ")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("with")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("open")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("input_file"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"rb"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" f"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("  \n        pdf "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" PdfFileReader"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("f"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  \n        pdf_writer "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" PdfFileWriter"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  \n          \n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 获取PDF文件的页数  ")]),t._v("\n        num_pages "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" pdf"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("getNumPages"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  \n          \n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 循环遍历每一页并加密  ")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" page "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("range")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("num_pages"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("  \n            page "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" pdf"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("getPage"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("page"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  \n            page"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("encrypt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("password"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  \n            pdf_writer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("addPage"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("page"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  \n              \n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 写入加密后的PDF文件  ")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("with")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("open")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("output_file"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"wb"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" f"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("  \n            pdf_writer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("write"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("f"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])])}),[],!1,null,null,null);s.default=p.exports}}]);