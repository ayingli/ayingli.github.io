(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{330:function(t,s,a){"use strict";a.r(s);var n=a(6),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"python批量对多个pdf文件进行解密"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#python批量对多个pdf文件进行解密"}},[t._v("#")]),t._v(" Python批量对多个PDF文件进行解密")]),t._v(" "),s("h3",{attrs:{id:"应用场景"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#应用场景"}},[t._v("#")]),t._v(" 应用场景：")]),t._v(" "),s("p",[t._v("批量对多个PDF文件进行解密的应用场景包括但不限于：")]),t._v(" "),s("ol",[s("li",[s("strong",[t._v("数据恢复")]),t._v("：在某些情况下，如误删除、格式化等，用户可能会丢失PDF文件。在这种情况下，可以使用批量解密工具来恢复这些文件，从而保护数据安全和完整性。")]),t._v(" "),s("li",[s("strong",[t._v("历史文献研究")]),t._v("：在历史文献研究中，常常会遇到加密的PDF文件。通过批量解密这些文件，可以方便研究人员进行深入分析和研究。")]),t._v(" "),s("li",[s("strong",[t._v("法律证据分析")]),t._v("：在法律案件中，有时会涉及到加密的PDF文件。通过批量解密这些文件，可以获取更多证据和信息，有助于案件的调查和分析。")]),t._v(" "),s("li",[s("strong",[t._v("企业内部文档流通")]),t._v("：在企业内部，可能会涉及到加密的PDF文件需要流通和共享。通过批量解密这些文件，可以提高工作效率和方便性。")]),t._v(" "),s("li",[s("strong",[t._v("个人隐私保护")]),t._v("：在一些情况下，如个人隐私保护、个人文件安全等，需要对加密的PDF文件进行解密。通过批量解密工具，可以方便快捷地解密多个文件，从而更好地保护个人隐私和文件安全。")])]),t._v(" "),s("h3",{attrs:{id:"代码实现思路"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#代码实现思路"}},[t._v("#")]),t._v(" 代码实现思路")]),t._v(" "),s("p",[t._v("要批量对多个PDF文件进行解密，可以使用Python中的PyPDF2库。首先输入解密密码，然后遍历指定目录下的所有PDF文件。对于每个PDF文件，我们使用PyPDF2库的PdfFileReader类读取PDF文件的内容，并使用PdfFileWriter类将解密后的内容写入到新的PDF文件中。最后，我们将解密后的PDF文件保存在指定的输出目录中。")]),t._v(" "),s("h3",{attrs:{id:"python代码实现"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#python代码实现"}},[t._v("#")]),t._v(" python代码实现")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" os  \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" PyPDF2 "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" PdfFileReader"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" PdfFileWriter  \n  \n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 输入解密密码  ")]),t._v("\npassword "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("input")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"请输入解密密码："')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  \n  \n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 遍历指定目录下的所有PDF文件  ")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" filename "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" os"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("listdir"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"path/to/pdf/files"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("  \n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" filename"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("endswith"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('".pdf"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("  \n        filepath "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" os"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("join"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"path/to/pdf/files"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" filename"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  \n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("with")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("open")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("filepath"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"rb"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" input_file"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("  \n            pdf_reader "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" PdfFileReader"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("input_file"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  \n            pdf_writer "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" PdfFileWriter"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  \n            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 获取第一页的内容并解密  ")]),t._v("\n            page "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" pdf_reader"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("getPage"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  \n            page"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("extractText"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  \n            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 将解密后的内容添加到PDF写入器中  ")]),t._v("\n            pdf_writer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("addPage"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("page"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  \n            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 输出解密后的PDF文件名和路径  ")]),t._v("\n            output_filename "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" filename"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"_decrypted.pdf"')]),t._v("  \n            output_filepath "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" os"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("join"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"path/to/output/folder"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" output_filename"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  \n            "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("with")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("open")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("output_filepath"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"wb"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" output_file"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("  \n                pdf_writer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("write"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("output_file"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])])}),[],!1,null,null,null);s.default=e.exports}}]);