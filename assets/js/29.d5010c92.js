(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{341:function(t,s,a){"use strict";a.r(s);var n=a(6),p=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"用python脚本将ppt中的内容导出为图片格式保存"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#用python脚本将ppt中的内容导出为图片格式保存"}},[t._v("#")]),t._v(" 用python脚本将PPT中的内容导出为图片格式保存")]),t._v(" "),s("h3",{attrs:{id:"应用场景"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#应用场景"}},[t._v("#")]),t._v(" 应用场景")]),t._v(" "),s("p",[t._v("将PPT中的文档导出成图片格式通常是在需要将PPT中的内容以图像的形式进行分享或保存的情况下使用的。将PPT中的文档导出成图片格式可以帮助您在不同的场景下方便地展示、打印、保存、转换和跨平台分享PPT文档。以下是一些常见的应用场景：")]),t._v(" "),s("ol",[s("li",[t._v("报告演示：当您需要向他人展示PPT时，可以将PPT中的文档导出成图片格式，以便在不依赖PPT播放器的情况下进行演示。")]),t._v(" "),s("li",[t._v("教程和指南：如果您正在编写关于如何使用特定软件或工具的教程或指南，可以将PPT中的文档导出成图片格式，以便读者可以更轻松地跟随您的步骤。")]),t._v(" "),s("li",[t._v("论文和研究：在进行学术研究或撰写论文时，您可能需要引用PPT中的文档。将PPT中的文档导出成图片格式可以方便地插入到论文中，同时避免因版本兼容性问题而导致的格式错误。")]),t._v(" "),s("li",[t._v("设计作品集：如果您是一名设计师，可以将PPT中的文档导出成图片格式，以便将其添加到您的设计作品集中，展示您的设计能力和风格。")]),t._v(" "),s("li",[t._v("社交媒体分享：在社交媒体上分享PPT时，将PPT中的文档导出成图片格式可以使内容更具吸引力，同时避免因平台限制而导致的格式问题。")]),t._v(" "),s("li",[t._v("邮件发送：在通过电子邮件发送PPT时，将PPT中的文档导出成图片格式可以避免因邮件客户端兼容性问题而导致的格式错误。")]),t._v(" "),s("li",[t._v("跨平台分享：如果您需要在不同的操作系统或设备之间分享PPT文档，可以选择将整个文档导出为图片格式，然后使用电子邮件或其他共享工具进行传输。")])]),t._v(" "),s("h3",{attrs:{id:"代码实现思路"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#代码实现思路"}},[t._v("#")]),t._v(" 代码实现思路")]),t._v(" "),s("ol",[s("li",[s("strong",[t._v("导入相关的Python库")]),t._v("。在这个案例中，我们需要使用"),s("code",[t._v("python-pptx")]),t._v("库，这个库可以让我们用Python操作PPT文件。另外，我们还需要使用"),s("code",[t._v("PIL")]),t._v("（Pillow）库，用于处理图片。")]),t._v(" "),s("li",[s("strong",[t._v("加载PPT文件")]),t._v("。使用"),s("code",[t._v("Presentation()")]),t._v("函数从PPT文件中加载内容。")]),t._v(" "),s("li",[s("strong",[t._v("遍历PPT的幻灯片")]),t._v("。我们可以使用"),s("code",[t._v("Presentation().slides")]),t._v("来获取所有的幻灯片。")]),t._v(" "),s("li",[s("strong",[t._v("从幻灯片中提取内容")]),t._v("。对于每个幻灯片，我们可以访问其"),s("code",[t._v("shapes")]),t._v("属性并遍历它们，从而可以提取出幻灯片中的各种内容，如文本、图像等。")]),t._v(" "),s("li",[s("strong",[t._v("将内容保存为图片")]),t._v("。对于提取的内容，我们可以使用PIL库的Image模块来将其保存为图片。对于文本内容，可能需要先将其转换为图像，然后再保存。")]),t._v(" "),s("li",[s("strong",[t._v("指定输出路径")]),t._v("。在保存图片之前，我们需要指定图片的保存路径。")])]),t._v(" "),s("h3",{attrs:{id:"python代码实现"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#python代码实现"}},[t._v("#")]),t._v(" python代码实现")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" pptx "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" Presentation  \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" pptx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("enum"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("shapes "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" MSO_SHAPE_TYPE  \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" PIL "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" Image  \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" os  \n  \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("save_slide_as_image")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("slide"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" output_folder"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("  \n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 获取幻灯片的形状  ")]),t._v("\n    shapes "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" slide"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("shapes  \n  \n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 遍历形状并保存为图片  ")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" shape "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" shapes"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("  \n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" shape"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("shape_type "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" MSO_SHAPE_TYPE"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("TEXT_BOX"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("  \n            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 对于文本框，先将其文本保存为图片  ")]),t._v("\n            text "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" shape"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("text_frame"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("text  \n            text_image "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Image"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("new"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'RGB'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("800")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("600")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("255")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("255")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("255")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  \n            text_image"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("text"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" text"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  \n            text_image"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("save"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("os"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("join"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("output_folder"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string-interpolation"}},[s("span",{pre:!0,attrs:{class:"token string"}},[t._v('f"text_')]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("shape"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("id")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('.png"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  \n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("elif")]),t._v(" shape"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("shape_type "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" MSO_SHAPE_TYPE"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("PICTURE"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("  \n            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 对于图片，直接保存  ")]),t._v("\n            shape"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("image"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("save"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("os"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("join"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("output_folder"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string-interpolation"}},[s("span",{pre:!0,attrs:{class:"token string"}},[t._v('f"image_')]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("shape"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("id")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('.png"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  \n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 其他类型的形状可以根据需要处理，如添加到图片上等  ")]),t._v("\n  \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("export_ppt_to_images")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ppt_path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" output_folder"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("  \n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 加载PPT文件  ")]),t._v("\n    prs "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Presentation"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ppt_path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  \n  \n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 获取PPT中的幻灯片  ")]),t._v("\n    slides "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" prs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("slides  \n  \n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 确保输出目录存在  ")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("not")]),t._v(" os"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exists"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("output_folder"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("  \n        os"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("makedirs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("output_folder"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  \n  \n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 遍历幻灯片，并导出为图片  ")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" i"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" slide "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("enumerate")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("slides"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("  \n        save_slide_as_image"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("slide"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" output_folder"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  \n  \n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 使用示例  ")]),t._v("\nppt_path "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"example.pptx"')]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# PPT文件路径  ")]),t._v("\noutput_folder "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"output"')]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 输出目录路径  ")]),t._v("\nexport_ppt_to_images"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ppt_path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" output_folder"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("注意：这个示例只处理了文本和图片两种类型的形状，对于其他类型的形状，可能需要根据具体的需求进行处理。例如，如果形状是表格，可能需要将其转换为图片；如果形状是形状（如箭头、矩形等），可能需要将其转换为对应的图片等。")])])}),[],!1,null,null,null);s.default=p.exports}}]);